import{k as i,o as S,e as x,w as a,s as v,q as e,v as y,c as Q,p as X,a as Z,aA as ee,a6 as te,ad as ae,K as oe,t as R,y as le}from"./index-BEALDuwY.js";import{E as ne,v as se}from"./el-empty-DekdHT7T.js";import{_ as re}from"./PageContainer-BVVqjsOY.js";import{E as ie}from"./el-pagination-CSgtznXV.js";import{E as z}from"./el-input-DnAPq_uS.js";import{B as ue,c as ce,d as de,E as pe,a as me}from"./book-E4EKsRa-.js";import{E as _e,a as fe,b as ve}from"./el-dialog-DK3q9f31.js";import{b as ge}from"./el-tooltip-BvgAGTTK.js";import{E as L,a as M}from"./el-form-item-BmTGu49f.js";import{E as U}from"./el-button-CffIBoYX.js";import"./el-overlay-MJv4Atf-.js";import{E as A}from"./el-message-box-CcJDXlBW.js";import{d as be}from"./defaultcover-BU2ujGGx.js";import{_ as he}from"./_plugin-vue_export-helper-Cm_HEwFR.js";import"./isEqual-BDJixwU5.js";import"./_initCloneObject-9ZzmZcU1.js";import"./event-BB_Ol6Sd.js";import"./refs-Det0-stg.js";import"./castArray-DxzSp_WQ.js";import"./_baseClone-Bqs5NyXE.js";import"./validator-DhiFKoQh.js";const ye={class:"dialog-footer"},ke={__name:"BookBorrow",emits:["refresh-list"],setup(F,{expose:m,emit:k}){const u=i({id:"",title:"",isbn:"",author:"",description:"",date:0}),g=i(),b={date:[{required:!0,message:"Please enter the date",trigger:"blur"},{pattern:/^(?:[1-9]|[1-9]\d|100)$/,message:"Must be a number between 1 and 100",trigger:"blur"}]},c=i(!1),E=i(),B=i(),_=()=>{const l=new Date,s=l.getFullYear(),r=String(l.getMonth()+1).padStart(2,"0"),d=String(l.getDate()).padStart(2,"0");E.value=`${s}-${r}-${d}`},V=l=>{const s=new Date,r=new Date(s.setDate(s.getDate()+parseInt(l))),d=r.getFullYear(),C=String(r.getMonth()+1).padStart(2,"0"),t=String(r.getDate()).padStart(2,"0");B.value=`${d}-${C}-${t}`},w=l=>{_(),console.log(E.value),V(l),console.log(B.value)},I=l=>{console.log(l),c.value=!0,u.value={...l}},p=k,$=async()=>{await g.value.validate(),w(u.value.date);const l=await ue({isbn:u.value.isbn,dueDate:B.value}),s=l.data.data.instanceId,r=l.data.data.location;c.value=!1,await A.alert("Request submitted<br>Book ID: "+s+"<br>Book Location:"+r,"Borrowing tips:",{confirmButtonText:"OK",dangerouslyUseHTMLString:!0}),p("refresh-list")};return m({open:I}),(l,s)=>{const r=z,d=L,C=M,t=U,n=_e;return S(),x(n,{title:"Please identify the books to be borrowed.:",modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=h=>c.value=h),width:"30%"},{footer:a(()=>[v("span",ye,[e(t,{onClick:s[1]||(s[1]=h=>c.value=!1)},{default:a(()=>[y("Cancel")]),_:1}),e(t,{type:"primary",onClick:$},{default:a(()=>[y("OK")]),_:1})])]),default:a(()=>[e(C,{ref_key:"formRef",ref:g,model:u.value,rules:b,"label-width":"100px",style:{"padding-right":"30px"}},{default:a(()=>[e(d,{prop:"",label:"Title"},{default:a(()=>[e(r,{placeholder:u.value.title,disabled:!0},null,8,["placeholder"])]),_:1}),e(d,{prop:"",label:"ISBN"},{default:a(()=>[e(r,{placeholder:u.value.isbn,disabled:!0},null,8,["placeholder"])]),_:1}),e(d,{prop:"",label:"Author"},{default:a(()=>[e(r,{placeholder:u.value.author,disabled:!0},null,8,["placeholder"])]),_:1}),e(d,{prop:"date",label:"Duration"},{default:a(()=>[e(r,{modelValue:u.value.date,"onUpdate:modelValue":s[0]||(s[0]=h=>u.value.date=h),placeholder:"Please enter the number of days of borrowing"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},Be={class:"form-row"},Ce=["title"],Se={class:"ellipsis"},Ee={style:{display:"flex"}},we={class:"pagination"},De={__name:"BookChannel",setup(F){const m=i([]),k=i(!1),u=i(0),g=i(1),b=i(5),c=async()=>{k.value=!0;const t=await ce();m.value=t.data.data,u.value=m.value.length,k.value=!1},E=Q(()=>{const t=(g.value-1)*b.value,n=t+b.value;return m.value.slice(t,n)});c();const B=()=>{c()},_=i(""),V=()=>{const t=m.value.filter(n=>{if(p.value==="title")return n.title.includes(_.value);if(p.value==="author")return n.author.includes(_.value);if(p.value==="isbn")return n.isbn.includes(_.value)});m.value.splice(0,m.value.length,...t)},w=()=>{_.value="",c()},I=i([{value:"title",label:"Title"},{value:"author",label:"Author"},{value:"isbn",label:"ISBN"}]),p=i("title"),$=t=>{if(t==="title")return"Please enter the book title";if(t==="author")return"Please enter the book author";if(t==="isbn")return"Please enter the ISBN"},l=i(),s=t=>{l.value.open(t)},r=()=>{c()},d=async t=>{await A.confirm("Are you sure?","Tip",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"Warning"}),de(t.isbn),le.success("Successful Reservation!")};X(p,t=>{console.log(t),w()});const C=t=>t?`url(data:image/jpeg;base64,${t})`:`url(${be})`;return(t,n)=>{const h=ve,O=fe,K=z,T=L,D=U,q=M,f=pe,P=ge,j=ne,Y=me,G=ie,H=re,W=se;return S(),x(H,{title:"Book Catalog"},{default:a(()=>[e(q,{inline:""},{default:a(()=>[v("div",Be,[e(O,{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=o=>p.value=o),placeholder:"Please select",class:"select-box"},{default:a(()=>[(S(!0),Z(te,null,ee(I.value,o=>(S(),x(h,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(T,null,{default:a(()=>[e(K,{modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=o=>_.value=o),placeholder:$(p.value),clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(T,null,{default:a(()=>[e(D,{type:"primary",onClick:V},{default:a(()=>[y("Search")]),_:1}),e(D,{onClick:w},{default:a(()=>[y("Reset")]),_:1})]),_:1})])]),_:1}),ae((S(),x(Y,{data:E.value,style:{width:"100%"}},{empty:a(()=>[e(j,{description:"No data"})]),default:a(()=>[e(f,{type:"index",label:"No",width:"100"}),e(f,{prop:"cover",label:"Cover"},{default:a(({row:o})=>[v("div",{class:"thumbnail",style:oe({"background-image":C(o.cover)})},null,4)]),_:1}),e(f,{prop:"title",label:"Title"}),e(f,{prop:"isbn",label:"ISBN"},{default:a(({row:o})=>[e(P,{class:"item",effect:"dark",placement:"bottom",content:o.isbn},{default:a(()=>[v("div",{class:"ellipsis",title:o.isbn},R(o.isbn),9,Ce)]),_:2},1032,["content"])]),_:1}),e(f,{prop:"description",label:"Description "},{default:a(({row:o})=>[e(P,{class:"item",effect:"dark",placement:"bottom",content:o.description},{default:a(()=>[v("div",Se,R(o.description),1)]),_:2},1032,["content"])]),_:1}),e(f,{prop:"author",label:"Author"}),e(f,{prop:"available",label:"Number of existing"}),e(f,{label:"Operation",width:"300"},{default:a(({row:o,$index:N})=>[v("div",Ee,[e(D,{type:"success",onClick:J=>s(o,N),disabled:o.available===0},{default:a(()=>[y("Borrow")]),_:2},1032,["onClick","disabled"]),e(D,{type:"primary",onClick:J=>d(o,N)},{default:a(()=>[y("Reserve")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[W,k.value]]),e(ke,{ref_key:"dialog",ref:l,onSuccess:B,onRefreshList:r},null,512),v("div",we,[e(G,{"current-page":g.value,"onUpdate:currentPage":n[2]||(n[2]=o=>g.value=o),"page-size":b.value,"onUpdate:pageSize":n[3]||(n[3]=o=>b.value=o),layout:"total,prev, pager, next, jumper",total:u.value,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),_:1})}}},We=he(De,[["__scopeId","data-v-d908ca8b"]]);export{We as default};
