import{_ as C}from"./PageContainer-BVVqjsOY.js";import{k as u,o as r,e as b,w as a,s as S,q as t,v as w,y as B,p as M,a as m,aA as Y,a6 as N,g as f,f as h,aB as P,aC as T}from"./index-BEALDuwY.js";import{L as $,G as U,R as q,E as F,a as O}from"./book-E4EKsRa-.js";import"./el-tooltip-BvgAGTTK.js";import{E as I}from"./el-button-CffIBoYX.js";import{E as j}from"./el-input-DnAPq_uS.js";import{E as G,a as K,b as z}from"./el-dialog-DK3q9f31.js";import"./el-overlay-MJv4Atf-.js";import{E as H,a as J}from"./el-form-item-BmTGu49f.js";import{E as Q}from"./el-date-picker-tQcjzh3L.js";/* empty css                   */import{E as W}from"./el-message-box-CcJDXlBW.js";import"./_plugin-vue_export-helper-Cm_HEwFR.js";import"./_initCloneObject-9ZzmZcU1.js";import"./isEqual-BDJixwU5.js";import"./event-BB_Ol6Sd.js";import"./refs-Det0-stg.js";import"./castArray-DxzSp_WQ.js";import"./_baseClone-Bqs5NyXE.js";import"./validator-DhiFKoQh.js";const X={class:"dialog-footer"},Z={__name:"LateReturn",setup(x,{expose:D}){const l=u({userId:"",borrowingId:"",instanceId:"",isbn:"",date:""}),y=u(),_={},s=u(!1),g=c=>{s.value=!0,l.value={...c},console.log(1),console.log(l.value)},k=async()=>{await y.value.validate(),await $({borrowId:l.value.borrowingId,lateRetDate:l.value.date}),s.value=!1,B.success("Successful Late Return Request!")};return D({open:g}),(c,d)=>{const v=j,o=H,p=Q,E=J,R=I,n=G;return r(),b(n,{title:"Please confirm late return:",modelValue:s.value,"onUpdate:modelValue":d[2]||(d[2]=i=>s.value=i),width:"30%"},{footer:a(()=>[S("span",X,[t(R,{onClick:d[1]||(d[1]=i=>s.value=!1)},{default:a(()=>[w("Cancel")]),_:1}),t(R,{type:"primary",onClick:k},{default:a(()=>[w("OK")]),_:1})])]),default:a(()=>[t(E,{ref_key:"formRef",ref:y,model:l.value,rules:_,"label-width":"100px",style:{"padding-right":"30px"}},{default:a(()=>[t(o,{prop:"",label:"User ID"},{default:a(()=>[t(v,{placeholder:l.value.userId,disabled:!0},null,8,["placeholder"])]),_:1}),t(o,{prop:"",label:"Book ID"},{default:a(()=>[t(v,{placeholder:l.value.instanceId,disabled:!0},null,8,["placeholder"])]),_:1}),t(o,{prop:"",label:"borrowDate"},{default:a(()=>[t(v,{placeholder:l.value.borrowDate,disabled:!0},null,8,["placeholder"])]),_:1}),t(o,{prop:"date",label:"Deferred Return to"},{default:a(()=>[t(p,{modelValue:l.value.date,"onUpdate:modelValue":d[0]||(d[0]=i=>l.value.date=i),type:"date",placeholder:"Pick a day",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},ee={class:"form-row"},te={key:0},ae={key:1},oe={key:2},le={key:3},re={key:4},ne={style:{display:"flex"}},Be={__name:"BookManage",setup(x){const D=async o=>{console.log(o.instanceId),await W.confirm("Are you sure you want to return it?","Tip",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}),await q(o.instanceId),B.success("Successful return!"),c(_.value)},l=u(),y=async o=>{l.value.open(o),c(_.value)},_=u("4"),s=u("4"),g=u([]),k=u(!1),c=async o=>{k.value=!0;const p=await U(o);console.log(p.data),g.value=p.data.data,k.value=!1};c(_.value);const d=()=>{c(_.value)},v=u([{value:"0",label:"Pending"},{value:"1",label:"Rejected"},{value:"2",label:"Returned"},{value:"3",label:"No Late Returns"},{value:"4",label:"Late Returns Allowed"}]);return M(s,o=>{c(o)}),(o,p)=>{const E=z,R=K,n=F,i=I,A=O,V=C;return r(),b(V,{title:"My Borrowing"},{extra:a(()=>[S("div",ee,[w(" Borrowing Status "),t(R,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=e=>s.value=e),placeholder:"Please Select",class:"select-box"},{default:a(()=>[(r(!0),m(N,null,Y(v.value,e=>(r(),b(E,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),default:a(()=>[t(A,{data:g.value},{default:a(()=>[t(n,{type:"index",label:"序号",width:"100"}),t(n,{label:"Book ID",prop:"instanceId"}),t(n,{label:"Reader ID",prop:"userId"}),t(n,{label:"Borrow Date",prop:"borrowDate"}),t(n,{label:"Due Date",prop:"dueDate"}),t(n,{label:"Return Date",prop:"returnDate"}),t(n,{label:"Request Status",prop:"borrowAprvStatus"},{default:a(e=>[e.row.borrowAprvStatus===0?(r(),m("span",te,"Pending")):f("",!0),e.row.borrowAprvStatus===2?(r(),m("span",ae,"Rejected")):f("",!0),e.row.returnDate!==null&&e.row.borrowAprvStatus===1?(r(),m("span",oe,"Returned")):f("",!0),e.row.lateRetAprvStatus!==null&&e.row.returnDate===null&&e.row.borrowAprvStatus===1?(r(),m("span",le,"No Late Returns")):e.row.lateRetAprvStatus===null&&e.row.returnDate===null&&e.row.borrowAprvStatus===1?(r(),m("span",re,"Late Returns Allowed")):f("",!0)]),_:1}),t(n,{label:"操作",width:"250"},{default:a(({row:e})=>[S("div",ne,[e.returnDate===null&&e.borrowAprvStatus===1?(r(),b(i,{key:0,plain:"",type:"primary",icon:h(P),onClick:L=>D(e)},{default:a(()=>[w("Return")]),_:2},1032,["icon","onClick"])):f("",!0),e.lateRetAprvStatus==null&&e.returnDate==null&&e.borrowAprvStatus==1?(r(),b(i,{key:1,plain:"",type:"warning",icon:h(T),onClick:L=>y(e)},{default:a(()=>[w("Late Return")]),_:2},1032,["icon","onClick"])):f("",!0)])]),_:1})]),_:1},8,["data"]),t(Z,{ref_key:"dialog",ref:l,onSuccess:d},null,512)]),_:1})}}};export{Be as default};
